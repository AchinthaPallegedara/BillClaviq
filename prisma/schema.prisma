datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model Company {
  id          String          @id @default(auto()) @map("_id") @db.ObjectId
  name        String
  phoneNumber String?
  address     String?
  logo        String?
  userId      String        
  invoices    Invoice[]     @relation("From")
  customers    Customer[] @relation("From")
}

model Invoice {
  id            String    @id @default(auto()) @map("_id") @db.ObjectId
  invoiceNumber String    @unique
  issueDate     DateTime
  dueDate       DateTime?
  status        InvoiceStatus
  discount      Float? @default(0.00)
  tax           Float? @default(0.00)
  subtotal      Float
  total         Float
  items         Item[]
  company       Company   @relation("From", fields: [fromId], references: [id], onDelete: Cascade)
  fromId        String    @db.ObjectId
  to            Customer @relation("To", fields: [toId], references: [id])
  toId          String    @db.ObjectId
}

model Item {
  id          String   @id @default(auto()) @map("_id") @db.ObjectId
  description String?
  quantity    Int @default(1)
  price       Float
  invoice     Invoice  @relation(fields: [invoiceId], references: [id], onDelete: Cascade)
  invoiceId   String   @db.ObjectId
}

model Customer {
  id           String  @id @default(auto()) @map("_id") @db.ObjectId
  name         String
  companyName  String?
  phoneNumber  String?
  address      String?
  company      Company @relation("From", fields: [fromId], references: [id], onDelete: Cascade)
  fromId       String    @db.ObjectId
  invoicesTo   Invoice[] @relation("To")
}

enum InvoiceStatus {
  DRAFT
  PAID
  OVERDUE
  PENDING
}